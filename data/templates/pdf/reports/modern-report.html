<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{{ title }}</title>
    <link rel="stylesheet" href="../stylesheets/modern.css">
</head>
<body>
    <!-- Title Page -->
    <div class="title-page">
        <h1>{{ title }}</h1>
        {% if subtitle %}
        <p class="subtitle">{{ subtitle }}</p>
        {% endif %}
        <p class="meta">
            {% if author %}{{ author }}<br>{% endif %}
            {{ date }}
        </p>
    </div>

    <!-- Header (running) -->
    <div class="header">
        {{ title }}
    </div>

    <!-- Executive Summary -->
    {% if executive_summary %}
    <section class="executive-summary">
        <h2>Executive Summary</h2>
        {{ executive_summary | safe }}
    </section>
    {% endif %}

    <!-- Table of Contents -->
    {% if show_toc %}
    <section>
        <h2>Contents</h2>
        <nav class="toc">
            {% for section in sections %}
            <div class="toc-item">
                <a href="#section-{{ loop.index }}">{{ section.heading }}</a>
            </div>
            {% endfor %}
        </nav>
    </section>
    <div class="page-break"></div>
    {% endif %}

    <!-- Main Content -->
    {% for section in sections %}
    <section id="section-{{ loop.index }}">
        <h2>{{ section.heading }}</h2>

        {% for paragraph in section.paragraphs %}
        <p>{{ paragraph.text }}</p>
        {% endfor %}

        {% if section.bullet_points %}
        <ul>
            {% for bullet in section.bullet_points %}
            <li>{{ bullet }}</li>
            {% endfor %}
        </ul>
        {% endif %}

        {% if section.table %}
        <table>
            <thead>
                <tr>
                    {% for header in section.table.headers %}
                    <th>{{ header }}</th>
                    {% endfor %}
                </tr>
            </thead>
            <tbody>
                {% for row in section.table.rows %}
                <tr>
                    {% for cell in row %}
                    <td>{{ cell }}</td>
                    {% endfor %}
                </tr>
                {% endfor %}
            </tbody>
        </table>
        {% endif %}

        {% if section.callout %}
        <div class="callout {{ section.callout_type | default('') }}">
            {{ section.callout }}
        </div>
        {% endif %}
    </section>
    {% endfor %}

    <!-- Conclusions -->
    {% if conclusions %}
    <section class="page-break">
        <h2>Conclusions</h2>
        {{ conclusions | safe }}
    </section>
    {% endif %}

    <!-- References -->
    {% if references %}
    <section>
        <h2>References</h2>
        <ol>
            {% for ref in references %}
            <li>{{ ref }}</li>
            {% endfor %}
        </ol>
    </section>
    {% endif %}

    <!-- Footer (running) -->
    <div class="footer">
        <span class="page-number"></span>
    </div>
</body>
</html>
